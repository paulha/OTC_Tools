#
#   This file should be located in ~/.jira/config.yaml
#

#
# -- Change to enable server dependent queries
#
servers:
    default:
        compare_priorities:
            search:     'project = "{sproject}" AND "Platform/Program" = "{splatform}" ORDER BY "Global ID" ASC'
            # TODO: Check: shouldn't this qualify by project as well?
            match:      '"Platform/Program" = "{tplatform}" AND "Android Version(s)" = "{taversion}" AND "Global ID" ~ {gid}'

        dump_parents:
            search:     'project = AREQ AND "Platform/Program" = "{splatform}" AND issuetype = E-Feature AND priority != P4-Low ORDER BY priority ASC'
            match:      'key = "{key}"'

        e_feature_scanner:
            # -- Find entries to (potentially) clone and modify...
            candidate_e-features:     'project = AREQ AND issuetype = E-Feature AND status in (Open, "In Progress", Closed, Merged, Blocked) AND "Android Version(s)" in ("{sversion}") AND "Platform/Program" in ("{splatform}")'
            parent_query:             'key = "{parent_key}"'
            sibling_query:            'parent="{parent_key}" and "Android Version(s)" in ("{tversion}") AND "Platform/Program" in ("{tplatform}")'

        scan_areq_and_check_for_preq:
            candidate_entries:        'labels in ("IOTG_IVI") AND issuetype = E-Feature and project = AREQ AND "Android Version(s)" in ("{sversion}") AND "Platform/Program" in ("{splatform}")'
            # -- TODO: Does the PREQ target have to be labeled with IOTG_IVI?
            target_entry:           'key = "{key}" AND project = PREQ AND "Android Version(s)" in ("{sversion}") AND "Platform/Program" in ("{splatform}")'
            # target_entry:           'key = "{key}" AND labels in ("IOTG_IVI") AND project = PREQ AND "Android Version(s)" in ("{sversion}") AND "Platform/Program" in ("{splatform}")'

        copy_platform_to_platform:
            preq_source_query:         'project = PREQ AND issuetype in standardIssueTypes() AND "Platform/Program" = "Broxton-P IVI" AND "Android Version(s)" in (O, O-MR1) AND priority in (P1-Stopper, P2-High, P3-Medium) AND component not in ("Audio Comms",Browser,Camera,Connectivity-Bluetooth,"Connectivity-FM Radio",Connectivity-GNSS,Connectivity-Ethernet,Connectivity-NFC,Documentation,"Energy Management",GPA,Hardware,HDMI,Houdini,"Manufacturing OS",Media,"OTA Update",PnP,"Power Management",Screencast,Sensors,SOCWatch,Telephony,Thermal,Validation,"Vehicle I/O",Video,VMM,"VTune and SEP","Widevine/DRM")'
            areq_source_e_feature:     'project = AREQ AND issuetype = E-Feature AND "Platform/Program" = "Broxton-P IVI" AND "Android Version(s)" in (O, O-MR1) AND priority in (P1-Stopper, P2-High, P3-Medium) AND component not in ("Audio Comms",Browser,Camera,Connectivity-Bluetooth,"Connectivity-FM Radio",Connectivity-GNSS,Connectivity-Ethernet,Connectivity-NFC,Documentation,"Energy Management",GPA,Hardware,HDMI,Houdini,"Manufacturing OS",Media,"OTA Update",PnP,"Power Management",Screencast,Sensors,SOCWatch,Telephony,Thermal,Validation,"Vehicle I/O",Video,VMM,"VTune and SEP","Widevine/DRM")'
            # Note: below that the Platform and Version are missing; the reference to IOTG_EMBEDDED makes this work for
            # Note: now. but I don't think it's really enough to be robust...
            areq_source_features:      'project = AREQ AND issuetype = Feature AND resolution = Unresolved AND labels = IOTG_EMBEDDED ORDER BY priority DESC, updated DESC'

    jira-t3:
        compare_priorities:
            search:     'project = "{sproject}" AND "Platform/Program" = "{splatform}" ORDER BY "Global ID" ASC'
            # TODO: Check: shouldn't this qualify by project as well?
            match:      '"Platform/Program" = "{tplatform}" AND "Android Version(s)" = "{taversion}" AND "Global ID" ~ {gid}'

        dump_parents:
            search:     'project = AREQ AND "Platform/Program" = "{splatform}" AND issuetype = E-Feature AND priority != P4-Low ORDER BY priority ASC'
            match:      'key = "{key}"'

        e_feature_scanner:
            # -- Find entries to (potentially) clone and modify...
            candidate_e-features:     'key=AREQ-22918 and project = AREQ AND issuetype = E-Feature AND status in (Open, "In Progress", Closed, Merged, Blocked) AND "Android Version(s)" in ("{sversion}") AND "Platform/Program" in ("{splatform}")'
            # candidate_e-features:     'project = AREQ AND issuetype = E-Feature AND status in (Open, "In Progress", Closed, Merged, Blocked) AND "Android Version(s)" in ("{sversion}") AND "Platform/Program" in ("{splatform}")'
            parent_query:             'key = "{parent_key}"'
            sibling_query:            'parent="{parent_key}" and "Android Version(s)" in ("{tversion}") AND "Platform/Program" in ("{tplatform}")'

        scan_areq_and_check_for_preq:
            candidate_entries:        'labels in ("IOTG_IVI") AND issuetype = E-Feature and project = AREQ AND "Android Version(s)" in ("{sversion}") AND "Platform/Program" in ("{splatform}")'
            # -- TODO: Does the PREQ target have to be labeled with IOTG_IVI?
            target_entry:           'key = "{key}" AND project = PREQ AND "Android Version(s)" in ("{sversion}") AND "Platform/Program" in ("{splatform}")'
            # target_entry:           'key = "{key}" AND labels in ("IOTG_IVI") AND project = PREQ AND "Android Version(s)" in ("{sversion}") AND "Platform/Program" in ("{splatform}")'

        copy_platform_to_platform:
            preq_source_query:         'project = PREQ AND issuetype in standardIssueTypes() AND "Platform/Program" = "Broxton-P IVI" AND "Android Version(s)" in (O, O-MR1) AND priority in (P1-Stopper, P2-High, P3-Medium) AND component not in ("Audio Comms",Browser,Camera,Connectivity-Bluetooth,"Connectivity-FM Radio",Connectivity-GNSS,Connectivity-Ethernet,Connectivity-NFC,Documentation,"Energy Management",GPA,Hardware,HDMI,Houdini,"Manufacturing OS",Media,"OTA Update",PnP,"Power Management",Screencast,Sensors,SOCWatch,Telephony,Thermal,Validation,"Vehicle I/O",Video,VMM,"VTune and SEP","Widevine/DRM")'
            areq_source_e_feature:     'project = AREQ AND issuetype = E-Feature AND "Platform/Program" = "Broxton-P IVI" AND "Android Version(s)" in (O, O-MR1) AND priority in (P1-Stopper, P2-High, P3-Medium) AND component not in ("Audio Comms",Browser,Camera,Connectivity-Bluetooth,"Connectivity-FM Radio",Connectivity-GNSS,Connectivity-Ethernet,Connectivity-NFC,Documentation,"Energy Management",GPA,Hardware,HDMI,Houdini,"Manufacturing OS",Media,"OTA Update",PnP,"Power Management",Screencast,Sensors,SOCWatch,Telephony,Thermal,Validation,"Vehicle I/O",Video,VMM,"VTune and SEP","Widevine/DRM")'
            # Note: below that the Platform and Version are missing; the reference to IOTG_EMBEDDED makes this work for
            # Note: now. but I don't think it's really enough to be robust...
            areq_source_features:      'project = AREQ AND issuetype = Feature AND resolution = Unresolved AND labels = IOTG_EMBEDDED ORDER BY priority DESC, updated DESC'

    jira01:
        compare_priorities:
            search:     'project = "{sproject}" AND "Platform/Program" = "{splatform}" ORDER BY "Global ID" ASC'
            # TODO: Check: shouldn't this qualify by project as well?
            match:      '"Platform/Program" = "{tplatform}" AND "Android Version(s)" = "{taversion}" AND "Global ID" ~ {gid}'

        dump_parents:
            search:     'project = AREQ AND "Platform/Program" = "{splatform}" AND issuetype = E-Feature AND priority != P4-Low ORDER BY priority ASC'
            match:      'key = "{key}"'

        e_feature_scanner:
            # -- Find entries to (potentially) clone and modify...
            candidate_e-features:     'project = AREQ AND issuetype = E-Feature AND status in (Open, "In Progress", Closed, Merged, Blocked) AND "Android Version(s)" in ("{sversion}") AND "Platform/Program" in ("{splatform}")'
            # candidate_e-features:     'Classification=Functional and project=AREQ AND issuetype = E-Feature AND status in (Open, "In Progress", Closed, Merged, Blocked) AND "Android Version(s)" in ("{sversion}") AND "Platform/Program" in ("{splatform}")'
            parent_query:             'key = "{parent_key}"'
            sibling_query:            'parent="{parent_key}" and "Android Version(s)" in ("{tversion}") AND "Platform/Program" in ("{tplatform}")'

        scan_areq_and_check_for_preq:
            candidate_entries:        'labels in ("IOTG_IVI") AND issuetype = E-Feature and project = AREQ AND "Android Version(s)" in ("{sversion}") AND "Platform/Program" in ("{splatform}")'
            # -- TODO: Does the PREQ target have to be labeled with IOTG_IVI?
            target_entry:           'key = "{key}" AND project = PREQ AND "Android Version(s)" in ("{sversion}") AND "Platform/Program" in ("{splatform}")'
            # target_entry:           'key = "{key}" AND labels in ("IOTG_IVI") AND project = PREQ AND "Android Version(s)" in ("{sversion}") AND "Platform/Program" in ("{splatform}")'

    jira-stg:
        compare_priorities:
            search:     'project = "{sproject}" AND "Platform/Program" = "{splatform}" ORDER BY "Global ID" ASC'
            # TODO: Check: shouldn't this qualify by project as well?
            match:      '"Platform/Program" = "{tplatform}" AND "Android Version(s)" = "{taversion}" AND "Global ID" ~ {gid}'

        dump_parents:
            search:     'project = AREQ AND "Platform/Program" = "{splatform}" AND issuetype = E-Feature AND priority != P4-Low ORDER BY priority ASC'
            match:      'key = "{key}"'

        e_feature_scanner:
            # -- Find entries to (potentially) clone and modify...
            candidate_e-features:     'project = AREQ AND issuetype = E-Feature AND status in (Open, "In Progress", Closed, Merged, Blocked) AND "Android Version(s)" in ("{sversion}") AND "Platform/Program" in ("{splatform}")'
            parent_query:             'key = "{parent_key}"'
            sibling_query:            'parent="{parent_key}" and "Android Version(s)" in ("{tversion}") AND "Platform/Program" in ("{tplatform}")'

        scan_areq_and_check_for_preq:
            candidate_entries:        'labels in ("IOTG_IVI") AND issuetype = E-Feature and project = AREQ AND "Android Version(s)" in ("{sversion}") AND "Platform/Program" in ("{splatform}")'
            # -- TODO: Does the PREQ target have to be labeled with IOTG_IVI?
            target_entry:           'key = "{key}" AND project = PREQ AND "Android Version(s)" in ("{sversion}") AND "Platform/Program" in ("{splatform}")'
            # target_entry:           'key = "{key}" AND labels in ("IOTG_IVI") AND project = PREQ AND "Android Version(s)" in ("{sversion}") AND "Platform/Program" in ("{splatform}")'

